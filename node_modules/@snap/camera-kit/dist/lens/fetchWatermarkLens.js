import { __awaiter } from "tslib";
import { take } from "rxjs";
import { Injectable } from "@snap/ts-inject";
import { remoteConfigurationFactory } from "../remote-configuration/remoteConfiguration";
import { getLogger } from "../logger/logger";
import { lensRepositoryFactory } from "./LensRepository";
const logger = getLogger("fetchWatermarkLens");
export const watermarksLensGroup = "watermarks";
export const fetchWatermarkLens = Injectable("fetchWatermarkLens", [remoteConfigurationFactory.token, lensRepositoryFactory.token], (remoteConfiguration, lensRepository) => {
    remoteConfiguration
        .getInitializationConfig()
        .pipe(take(1))
        .subscribe({
        next: (config) => __awaiter(void 0, void 0, void 0, function* () {
            if (config.watermarkEnabled) {
                const lens = yield lensRepository.loadLens("", watermarksLensGroup);
                yield lensRepository.cacheLensContent([lens]);
            }
        }),
        error: logger.error,
    });
});
//# sourceMappingURL=fetchWatermarkLens.js.map